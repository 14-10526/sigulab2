{{extend 'layout.html'}}

{{block head}}
  <!-- Hoja de estilos específica para la página de gestión de servicios -->

    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="http://cdn.datatables.net/1.10.7/js/jquery.dataTables.js"></script>
    <script src="{{=URL('static', 'plugins/datatables2/dataTables.rowsGroup.js')}}"></script>
    
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.flash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.print.min.js "></script>


    <link rel="stylesheet" href="http://cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css">
  	<link rel="stylesheet" href="{{=URL('static','css/sigulab2servicios.css')}}">
	<link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventarios_desechos.css')}}"> 

	<link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.5.2/css/buttons.dataTables.min.css">	


{{end}}

{{block center}}

<!-- Breadcrumb de navegación -->
<nav class="navbar navbar-inverse navbar-fixed-top breadcrumbs">
  <div class="breadcrumb">
  <a class="breadcrumb-item" href="{{=URL('..', 'sigulab2')}}">Inicio</a>
  <span class="breadcrumb-item active">Personal</span>
  </div>
</nav>
<!-- Fin del Breadcrum de navegación -->

<!-- Contenido principal de la página de gestión de servicios -->
<div class="container titulo">
    <h2>Resultados búsqueda</h1>
    <br>
    <p>
    {{if filtros['gremio_busqueda'] != None: }}
    <b>Gremio: </b> {{=filtros['gremio_busqueda']}}
    {{pass}}
    {{if filtros['cargo_busqueda'] != "": }}
    <br>
    <b>Cargo: </b>{{=filtros['cargo_busqueda']}}
    {{pass}}
    {{if filtros['competencia_busqueda'] != "": }}
    <br>
    <b>Competencia: </b>{{=filtros['competencia_busqueda']}}
    {{pass}}
    {{if filtros['categoria_busqueda'] != None: }}
    <br>
    <b>Categoria: </b>{{=filtros['categoria_busqueda']}}
    {{pass}}
    {{if filtros['anios_busqueda'] != None: }}
    <br>
    <b>Años servicio ULAB: </b>{{=filtros['anios_busqueda'] +  " años"}}
    {{pass}}

    {{if filtros['fecha_busqueda'] != "": }}
    {{="para la fecha " + filtros['fecha_busqueda']}}
    {{pass}}
    </p>
</div>
<div id="main" class="container">


<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
	<div class="panel">
		<div class="panel-body-users-tab no-padding" style="background-color:#fafafa;">
			<table id="example" class="">
				<thead class="bg-primary">
					<tr>
						<th class="nombre tableColumn">Nombre</th>
						<th class="dependencia tableColumn">Dependencia</th>
						<th class="correo tableColumn">Correo</th>
						<th class="telefono tableColumn">Telefono</th>
						<th class="gremio tableColumn">Gremio</th>
						<th class="compnombre tableColumn">Competencia - Nombre</th>
						<th class="compcategoria tableColumn">Competencia - Categoria</th>
						<th class="anios tableColumn">años</th>
						<th class="cargo1 tableColumn">cargo1</th>
						<th class="cargo2 tableColumn">cargo2</th>
						<th class="cargo3 tableColumn">cargo3</th>
						<th class="cargo4 tableColumn">cargo4</th>
						<th class="cargo5 tableColumn">cargo5</th>
					</tr>
				</thead>
				<tbody>
                    {{ for item in lista: }}
                    <tr>
                        <td>{{=item['nombre']}}</td>
                        <td>{{=item['dependencia']}}</td>
                        <td>{{=item['correo']}}</td>
                        <td>{{=item['telefono']}}</td>
                        <td>{{=item['gremio']}}</td>
                        <td>{{=item['competencia']}}</td>
                        <td>{{=", ".join(item['categorias'])}}</td>
                        <td>{{=item['anios-servicio']}}</td>
                        <td>{{=item['cargo1']}}</td>
                        <td>{{=item['cargo2']}}</td>
                        <td>{{=item['cargo3']}}</td>
                        <td>{{=item['cargo4']}}</td>
                        <td>{{=item['cargo5']}}</td>
                    </tr>
                    {{pass}}
                </tbody>
			</table>
		</div>
	</div>
</div>
</div>
<!-- Fin del contenido principal de la página de gestión de servicios -->
<script charset="utf-8">
    $(document).ready(function() {
        var table = $('#example').DataTable({
        "paging":   false,
        "info":     false,
        language: {
        url: "{{=URL('static', 'plugins/datatables/l18n/es-ES.json')}}"
    },	
    	dom: 'Bfrtip',
    	buttons: [
           {
            extend: 'pdf',
            text: "Descargar reporte",
            title: "Resultados búsqueda",
            exportOptions: {
                    columns: ':visible'
                }
        }
        ],

        rowsGroup: [0, 1, 2, 3, 4, 7],
        "columnDefs": [
            {
                "targets": [ 6, 7, 8, 9, 10, 11, 12],
                "visible": false,
                "searchable": true
            },
        ]
        });

      // busqueda por nombre competencias
      //table.columns('.comp-nombre').search('analista').draw();
      // busqueda por gremio
      table.columns('.gremio')
        .search('{{=filtros['gremio_busqueda'] or ''}}')
        .draw();
      // busqueda por Competencias
      table.columns('.compnombre')
        .search('{{=filtros['competencia_busqueda'] or ''}}')
        .draw();
      // busqueda por Categorias
      table.columns('.compcategoria')
        .search('{{=filtros['categoria_busqueda'] or ''}}')
        .draw();
      // busqueda por Años
      table.columns('.anios')
        .search('{{=filtros['anios_busqueda'] or ''}}')
        .draw();
      // Busqueda por Cargos
      table.columns('.cargo1 .cargo2 .cargo3 .cargo4 .cargo5')
        .search('{{=filtros['cargo_busqueda'] or ''}}')
        .draw();
    } );
</script>
{{end}}
