<!-- Contiene la seccion del listado de sustancias cuando se visita un espacio fisico especifico -->

<!-- Inicio Boton Agregar Sustancia -->
<div class="container" id="containerAgregar">
    <div class="row">
        <div class="col-sm-6"></div>
        <div id="columnBotonAgregar" class="col-sm-6">
	        <div class="col-sm-6"></div>
	        <div class="col-sm-6">
	            <!-- Boton que lleva al modal --> <!-- Cambiar data-target="#addservice por el id de la forma de la sustancia -->
	            <button type="button" id="botonAgregar" class="btn botonesListado" data-toggle="modal" data-target="#addsustancia">Agregar Sustancia</button>
	        </div>
        </div>
    </div>
</div>
<!-- Fin Boton Agregar Sustancia -->

<!-- Inicio Listado de sustancias -->
<div class="container">
<div class="row">
  <h3> Listado de Servicios </h3>

    <div id="buttons">
      <!-- Filtrado -->
        <button type="button" id="filtrar" onclick="mostrarFiltro()" class="btn btn-default buttons-pdf buttons-html5">Filtrado</button>
      <!-- Filtrado -->    
    </div>
    <br>

    <div class="table-responsive no-padding no-margin">
      <table id="datatable" class="table table-hover table-striped dt-responsive display tablaListado" cellspacing="0" width="100%">
        <thead>
            <tr id="titulosListado">
                <th class="camposTabla linksNombres">Nombre</th>
                <th class="camposTabla linksNombres">CAS</th>
                <th class="camposTabla linksNombres">Pureza</th>
                <th class="camposTabla linksNombres">Estado</th>
                <th class="camposTabla linksNombres">Existencia</th>
                <!--
                <th class="camposTabla linksNombres">Unidad</th>
                -->
                <th class="camposTabla linksNombres">Uso interno</th>
                <th class="camposTabla linksNombres">Excedente</th>
            </tr>
        </thead>

        <tbody>
          {{for sustancia in inventario:}}
            {{sust = sustancia['t_Sustancia']}}
            {{inv = sustancia['t_Inventario']}}
            <tr>
                <td class="camposTabla">{{=sust.f_nombre}}</td>
                <!-- Colocar anchor a la entrada de la sustancia en el catalogo de sustancias -->
                <td class="camposTabla">{{=sust.f_cas}}</td>
                <td class="camposTabla">{{=sust.f_pureza}}</td>
                <td class="camposTabla">{{=sust.f_estado[0] if len(sust.f_estado) > 0 else None}}</td>
                <td class="camposTabla">{{=inv.f_existencia}}</td>
                <td class="camposTabla">{{=inv.f_uso_interno}}</td>
                <td class="camposTabla">{{=int(inv.f_existencia) - int(inv.f_uso_interno)}}</td>
            </tr>
          {{pass}}           
        </tbody>

        <tfoot id="collapseFiltros">
            <tr>
                <th class="camposTabla linksNombres">Nombre</th>
                <th class="camposTabla linksNombres">CAS</th>
                <th class="camposTabla linksNombres">Pureza</th>
                <th class="camposTabla linksNombres">Estado</th>
                <th class="camposTabla linksNombres">Existencia</th>
                <!--
                <th class="camposTabla linksNombres">Unidad</th>
                -->
                <th class="camposTabla linksNombres">Uso interno</th>
                <th class="camposTabla linksNombres">Excedente</th>
            </tr>
        </tfoot>

      </table>
    </div>
  </div>
</div>  
<!-- Fin Listado de sustancias --> 

<!-- Ajax abrirFicha para mostrar la informacion de la sustancia seleccionada con un modal -->
<input type="hidden" id="serv" name="serv" value="">


<!-- Modal aÃ±adir una sustancia nueva al inventario -->
  <div class="modal fade" id="addsustancia" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">

        <!-- Modal Header -->
        <div class="modal-header addHeader">
          <div class="row addRow" id="rowHeader">
            <div class="col-sm-1" id="col1Header">
              <div class="container" id="plus">
                <h1 id="agregar">+</h1>
              </div>
            </div>
            <div class="col-sm-10" id="col11Header">
              <h4 class="modal-title" id="nuevaSustancia">Nueva Sustancia
                <button type="button" class="close" data-dismiss="modal">&times;</button>
              </h4>
            </div>
          </div>
        </div>
        <!-- Fin Modal Header -->
        
        <!-- Modal Body -->
        <div class="modal-body addBody">
          <div class="row addRow">
            <div class="col-md-12 form-box">
                <form id="formularioCarga" class="registration-form" method="post">

                  <!-- Primer Paso -->
                  <fieldset class="formField">
                    <!-- Aqui va la informacion -->
                    <div class="col-sm-11 col11Body">
                      <h4 class="titulosForm">Datos de ingreso</h4>                
                      <label>Campos marcados con * son obligatorios.</label>
                        <div class="form-group">
                          <select class="form-control" type="select" id="sustancia" name="sustancia" required>
                            <option value="" selected hidden >Sustancia*</option>
                            {{for sustancia in sustancias:}}
                            <option value="{{=sustancia.id}}">{{=sustancia.f_nombre}} ({{=sustancia.f_cas}})</option>
                            {{pass}}
                          </select>
                        </div>
                        <div class="form-group">
                          <input type="text" class="form-control" name="excedente" placeholder="Cantidad total*" required>
                        </div>
                        <div class="form-group">
                          <input type="text" class="form-control" name="uso_interno" placeholder="Uso interno*" required>
                        </div>
                    </div>
                  </fieldset>
                  <!-- Fin Primer Paso -->
                </form>
            </div>
          </div>               
        </div>
      </div>
    </div>
  </div>

<!-- Fin Modal Agregar Servicio -->


