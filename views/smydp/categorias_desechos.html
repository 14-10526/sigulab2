{{extend 'layout.html'}} {{block head}}
<link rel="stylesheet" href="{{=URL('static', 'css/smydp_catalogo.css')}}"> 
<link rel="stylesheet" href="{{=URL('static', 'css/smydp_categorias_desechos.css')}}"> 

<!-- DataTables -->
<link href="{{=URL('static', 'plugins/datatables/jquery.dataTables.min.css')}}" rel="stylesheet" type="text/css" />
<link href="{{=URL('static', 'plugins/datatables/buttons.bootstrap.min.css')}}" rel="stylesheet" type="text/css" />
<link href="{{=URL('static', 'plugins/datatables/responsive.bootstrap.min.css')}}" rel="stylesheet" type="text/css" />	
<!-- Estilos de modales y listados -->
<link rel="stylesheet" type="text/css" href="{{=URL('static', 'css/smydp_modal.css')}}">
<link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventarios_desechos.css')}}"> 
<link rel="stylesheet" href="{{=URL('static', 'css/smydp_listado.css')}}">
<link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventario_dependencia.css')}}">
<link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventario_espacio.css')}}">
<link rel="stylesheet" href="{{=URL('static', 'css/smydp_template_modal.css')}}">	  
<script src="{{=URL('static', 'js/smydp_template_modal.js')}}"></script>
{{end}} {{block center}}

<!-- Breadcrumb de navegación -->
<nav class="navbar navbar-inverse navbar-fixed-top breadcrumbs">
    <div class="breadcrumb">
        <a class="breadcrumb-item" href="{{=URL('..', 'sigulab2')}}">Inicio</a>
        <a class="breadcrumb-item" href="{{=URL('..', 'sigulab2', 'smydp')}}">SMyDP</a>
        <a class="breadcrumb-item" href="{{=URL('..', 'sigulab2', 'smydp/desechos')}}">Desechos peligrosos</a>
        <span class="breadcrumb-item active">Categorías de Desechos</span>
    </div>
</nav>
<!-- Fin del Breadcrumb de navegación -->

<div class="container titulo">
        {{if ('edit' in request.args) or ('view' in request.args):}}
        <div class="row">
            <div class="col-lg-12 text-center">
                <h3 class="inicio-titulo">DETALLE DE LA CATEGORÍA</h3>
                <img class="iconos" src="{{=URL('static', 'images/detallecategoria.png')}}">
            </div>
        </div>
    {{elif ('new' in request.args):}}
        <div class="row">
            <div class="col-lg-12 text-center">
                <h3 class="inicio-titulo">NUEVA CATEGORÍA DE DESECHO</h3>
                <img class="iconos" src="{{=URL('static', 'images/nuevacategoria.png')}}">
            </div>
        </div>
    {{else:}}
        <div class="row">
            <div class="col-lg-12 text-center">
                <h3 class="inicio-titulo">CATEGORÍAS DE DESECHOS - ULAB</h3>
                <img class="iconos" src="{{=URL('static', 'images/categorias.png')}}">
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 text-right">
                <a href="{{=URL('..', 'sigulab2', 'smydp/categorias_desechos/t_categoria_desechos/new/t_categoria_desechos')}}">
                    <button class="btn btn-primary">Agregar categoría</button>
                </a>
            </div>
        </div>
        {{pass}} 
    {{pass}}
</div>

{{if table.create_form:}} 
    {{=table.create_form}} 
    <script>
        let boton = document.getElementsByClassName("btn btn-primary");
        boton[2].style.display = "none";
        let form = document.querySelector("form");
        var div_node = document.createElement("div");
        div_node.className += " col-lg-12 text-center";
        var button_node = document.createElement("button");
        var textnode = document.createTextNode("Agregar Categoría");
        button_node.appendChild(textnode);
        button_node.className += " btn btn-primary";  
        div_node.appendChild(button_node);      
        form.appendChild(div_node);
    </script>
{{elif table.update_form:}} 
    {{=table.update_form}} 
{{elif table.view_form:}}
    {{=table.view_form}} 
{{else:}}
    <div class="container">
        {{=table}}
    </div>
{{pass}}

{{if ('view' in request.args):}}
<div class="row">
    <div class="col-lg-12 text-center">
        <a href="{{=URL('..', 'sigulab2', 'smydp/categorias_desechos/t_categoria_desechos/edit/t_categoria_desechos/' + request.args[3])}}">
            <button class="btn btn-warning botones-edicion">Editar</button>
        </a>
        <a href="{{=URL('..', 'sigulab2', 'smydp/categorias_desechos/t_categoria_desechos/delete/t_categoria_desechos/' + request.args[3])}}">
            <button class="btn btn-danger botones-edicion">Eliminar</button>
        </a>
    </div>
</div>
<script>
    let ids = ["#t_categoria_desechos_categoria__row","#t_categoria_desechos_id__row"];
    for (let index = 0; index < ids.length; index++) {
        const element = document.querySelector(ids[index]);
        element.children[0].className = "readonly control-label col-sm-2 col-sm-offset-4";
        element.children[1].className = "readonly control-label col-sm-2";        
        element.children[0].style.textAlign = "center";
        element.children[1].style.textAlign = "center";
        element.style.marginBottom = "0px";
    }
</script>
{{pass}}

{{if ('edit' in request.args):}}
    <script>
        let check_to_delete_label = document.getElementById("delete_record__label");
        check_to_delete_label.style.display = "none";
        let inputs = document.querySelectorAll('input[type=submit]');
        inputs[0].value = "Guardar cambios";
        inputs[0].style.marginTop = "-40px";
        inputs[0].className += " text-center";
    </script>
{{pass}}


<script>
    // Eliminando el breadcrumb que trae la forma SQL por defecto
    document.getElementsByClassName("web2py_breadcrumbs")[0].style.display = 'none';
    // Set blue bar below INICIO text.
    document.getElementById("smydp").className += " active";
</script> 

<!-- Datatables-->
<script src="{{=URL('static', 'plugins/datatables/jquery.dataTables.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/dataTables.bootstrap.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/dataTables.buttons.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/buttons.bootstrap.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/jszip.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/pdfmake.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/vfs_fonts.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/buttons.html5.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/buttons.print.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/dataTables.responsive.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/responsive.bootstrap.min.js')}}"></script>



<!-- Datatable init js -->
<script src="{{=URL('static', 'plugins/datatables/datatables.init.js')}}"></script>
<script>

    var filtros = false;
  
    $(document).ready(function() {
        // Setup - add a text input to each footer cell
        $('#datatable tfoot th').each( function () {
            var title = $(this).text();
            $(this).html( '<input type="text" placeholder="Filtro" />' );
        } );
     
        // DataTable
        var table = $('#datatable').DataTable();
     
        // Apply the search
        table.columns().every( function () {
            var that = this;
     
            $( 'input', this.footer() ).on( 'keyup change', function () {
                if ( that.search() !== this.value ) {
                    that
                        .search( this.value )
                        .draw();
                }
            } );
        } );
  
        $('#datatable tfoot tr').appendTo('#datatable thead');
        $("#datatable thead tr").not("#titulosListado").css("display","none");
    } );
  
    function mostrarFiltro() {
        if (filtros){
          $("#datatable thead tr").not("#titulosListado").css("display","none");
          filtros = false
        }
        else{
          $("#datatable thead tr").not("#titulosListado").css("display","table-row");
          filtros = true
        }
  
    }
  </script>
   
  <script language="javascript">
    var table = $('#datatable').DataTable({
      language: {
        url: "{{=URL('static', 'plugins/datatables/l18n/es-ES.json')}}"
      },
     initComplete: function(){
        var api = this.api();
  
        new $.fn.dataTable.Buttons(api, {
           buttons: [
              'copy', 'pdf', 'excel', 'csv', 'print'
           ]
        });
        api.buttons().container().appendTo('#buttons');  
     }
    });
  
  </script>
<script>  
    let inputs = document.querySelectorAll('input[type=submit]');
    inputs[0].style.display = "none";
    inputs[1].value = 'Limpiar';
    inputs[1].className += " btn btn-primary";
    inputs[1].style.margin = "15px 0px";   

    // Oculta el boton de 'Add record' que trae la tabla por defecto
    let boton1 = document.getElementsByClassName("btn btn-default");
    boton1[0].style.display = "none";

    // Coloca en español el botón de New Search y Close del panel de búsqueda de la tabla y
    // oculta los botones de and y or.
    document.getElementById("w2p_keywords").addEventListener('click', function() {
        const campos = ['id', 'categoria'];

        campos.forEach(campo => {
            let parent = document.getElementById("w2p_field_t_categoria_desechos-" + campo);
            let children = parent.getElementsByClassName('btn-default');

            children[0].value = "Buscar";
            children[1].style.display = "none";
            children[2].style.display = "none";
            children[3].value = "Cerrar";
            children[0].className += " btn btn-primary botones-busqueda";
            children[3].className += " btn btn-primary botones-busqueda";

        });
    });
    // Se coloca en español el mensaje que dice "XXX rows founds"
    let row_counter = document.getElementsByClassName("web2py_counter");
    let row_content = row_counter[0].innerText.split(" ");
    row_counter[0].innerText = row_content[0] + " entrada(s) encontrada(s)";
    row_counter[0].style.marginBottom = "15px";
    // Se colocan en español los botones de la columna de opciones de la tabla
    let row_buttons = document.getElementsByClassName("row_buttons");

    for (let index = 0; index < row_buttons.length; index++) {
        
        let children = row_buttons[index].getElementsByClassName("button btn btn-default");
        children[0].innerText = "Ver";
        children[0].className += " btn btn-primary";
        children[1].style.display = "none";
        children[2].style.display = "none";
    }
</script>

  {{end}}