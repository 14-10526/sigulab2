<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <link href="{{=URL('static','css/bootstrap.min.css')}}" rel="stylesheet" type="text/css" />
    <link href="{{=URL('static','css/core.css')}}" rel="stylesheet" type="text/css"/>
    <link href="{{=URL('static','css/components.css')}}" rel="stylesheet" type="text/css"/>
    <link href="{{=URL('static','css/icons.css')}}" rel="stylesheet" type="text/css"/>
    <link href="{{=URL('static','css/pages.css')}}" rel="stylesheet" type="text/css"/>
    <link href="{{=URL('static','css/menu.css')}}" rel="stylesheet" type="text/css"/>
    <link href="{{=URL('static','css/responsive.css')}}" rel="stylesheet" type="text/css"/>
    <link href="{{=URL('static','css/servicios_login.css')}}" rel="stylesheet" type="text/css"/>
    <script src="{{=URL('static','js/modernizr.min.js')}}"></script>
</head>
<body>
<!-- Inicio Wrapper -->
<div class="wrapper-page pagina">

    <!-- Inicio card box -->
    <div id="boxRegister" class="m-t-40 card-box boxes">
        <div class="text-center">
            <h4 id="titulo" class="text-uppercase font-bold m-b-0">Registro</h4>
        </div>
        
        <!-- Inicio panel -->
        <div class="panel-body">

        <!-- Inicio form de registro -->
        <form action="#" class="form-horizontal form-horizontal m-t-20" enctype="multipart/form-data" method="post">

            <!-- Nombre -->
            <div class="form-group" id="auth_user_first_name__row">
                <div class="col-xs-12">
                    <input class="form-control string" id="auth_user_first_name" name="first_name" type="text" placeholder="Nombre" value="" required>
                    <span class="help-block"></span>
                </div>
            </div>

            <!-- Apellido -->
            <div class="form-group" id="auth_user_last_name__row">
                <div class="col-xs-12">
                    <input class="form-control string" id="auth_user_last_name" name="last_name" type="text" placeholder="Apellido" value="" required>
                    <span class="help-block"></span>
                </div>
            </div>

            <!-- Email -->
            <div class="form-group" id="auth_user_email__row">
                <div class="col-xs-12">
                    <input class="form-control string" id="auth_user_email" name="email" type="text" placeholder="Correo Electrónico" value="" required>
                    <span class="help-block"></span>
                </div>
            </div>

            <!-- Contraseña -->
            <div class="form-group" id="auth_user_password__row">
                <div class="col-xs-12">
                    <input class="form-control password" id="auth_user_password" name="password" type="password" placeholder="Contraseña" value="" required>
                    <span class="help-block"></span>
                </div>
            </div>

            <!-- Confirmar contraseña --> 
            <div class="form-group" id="auth_user_password_two__row">
                <div class="col-xs-12">
                    <input class="form-control password" id="auth_user_password_two" name="password_two" type="password" placeholder=" Confirmar Contraseña" value="" required>
                    <span class="help-block"></span>
                </div>
            </div>

            <!-- Tipos de Rol -->
            <div class="form-group">
                <div class="col-xs-12">
                    <select class="form-control" type="select" required="" id="rol" name="rol" placeholder="Rol" onchange="getUnidad(); getSeccion();">
                        <option value="" selected hidden disabled>Rol</option>
                        {{for rol in roles:}}
                        <option value='{{=rol.id}}'>{{=rol.role}}</option>
                        {{pass}}
                    </select>
                </div>
            </div>

            <div id="unidaddiv" class="form-group"></div>

            <div id="secciondiv" class="form-group"></div>

            <div class="form-group text-center m-t-40" id="submit_record__row">

                <div class="col-xs-12 col-sm-offset-3" onclick="setMembership();">
                    <input class="btn btn-primary" type="submit" value="Registrarse">
                </div>
            </div>
            {{=form.custom.begin}}
            {{=form.custom.end}}
            {{if form.errors:}}
              <ul>
              {{for fieldname in form.errors:}}
                <li> error: {{=form.errors[fieldname]}}</li>
              {{pass}}
              </ul>
              {{form.errors.clear()}}
            {{pass}}
        </form>
        <!-- Fin form de registro -->
        </div>
        <!-- Fin Panel -->
    </div>
    <!-- Fin card-box -->
</div>
<!-- Fin Wrapper -->
<input type="hidden" id="dependenciahidden" name="dependenciahidden" value="">
</body>

<input type="hidden" id="seccionhidden" name="seccionhidden" value="">
</body>

<script language="javascript" src="../static/js/jQuery.js"></script>
<script language="javascript" src="../static/js/web2py.js"></script>
<script language="javascript">
    function setMembership(){
        ajax('ajax_membership', ['laboratorio', 'rol', 'seccion'], 'hiddendiv');
    }

    function getUnidad(){
        var opcionesrol = document.getElementById("rol");
        var rolelegida = opcionesrol.options[opcionesrol.selectedIndex].value;
        var x = document.getElementById("dependenciahidden");
        x.value = rolelegida;
        ajax('ajax_unidad_rol', ['dependenciahidden'], 'unidaddiv');
    }

    function getSeccion(){
        var opcionesrol = document.getElementById("rol");
        var rolelegida = opcionesrol.options[opcionesrol.selectedIndex].value;
        var opcioneslab = document.getElementById("laboratorio");
        var labelegido = opcioneslab.options[opcioneslab.selectedIndex].value;
        var x = document.getElementById("dependenciahidden");
        x.value = rolelegida;
        var x = document.getElementById("seccionhidden");
        x.value = labelegido;
        ajax('ajax_registro_seccion', ['dependenciahidden', 'seccionhidden'], 'secciondiv');
    }

</script>
</html>
