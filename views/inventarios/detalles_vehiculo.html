{{extend 'layout.html'}}
{{block head}}

<meta charset="UTF-8">

    <!-- Para los mensajes con flash -->
    <link rel="stylesheet" href="{{=URL('static','css/web2py-bootstrap3-flash.css')}}"/>
	<link rel="stylesheet" type="text/css" href="{{=URL('static', 'plugins/datatables2/datatables.min.css')}}"/>
	<script type="text/javascript" src="{{=URL('static', 'plugins/datatables2/datatables.min.js')}}"></script>
    <link rel="stylesheet" href="{{=URL('static', 'css/servicios_modal.css')}}">
    <link rel="stylesheet" href="{{=URL('static', 'inventarios/css/template_modal.css')}}">
     <link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventarios.css')}}"> 
     <link rel="stylesheet" href="{{=URL('static', 'inventarios/css/listado.css')}}">
     <link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventario_dependencia.css')}}">
     <link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventario_espacio.css')}}">
    <!-- Estilos de modales y listados -->
      <!-- Estilo del listado de Solicitudes de Servicios -->
    <link rel="stylesheet" href="{{=URL('static', 'css/servicios_solicitud.css')}}">
    <link rel="stylesheet" href="{{=URL('static', 'css/servicios_modal.css')}}">
    <link rel="stylesheet" href="{{=URL('static', 'inventarios/css/template_modal.css')}}">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    <script src="{{=URL('static', 'js/inventario_template_modal.js')}}"></script>   
    <!-- Web2py JS - Especialmente para AJAX -->
    <script src="{{=URL('static', 'js/web2py.js')}}"></script>
    <style>
    .row{
        margin-right:0px!important;
    }
     </style>

<link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventarios.css')}}">
<link rel="stylesheet" href="{{=URL('static', 'inventarios/css/detalles_bm.css')}}">
{{end}}

{{block center}}

<!-- Bloque de navegación secundaria (breadcrumb) -->
<nav class="navbar navbar-inverse navbar-fixed-top breadcrumbs">
  <div class="breadcrumb">
  <a class="breadcrumb-item" href="{{=URL('..', 'sigulab2')}}">Inicio</a>
  <a class="breadcrumb-item" href="{{=URL('..', 'sigulab2', 'inventarios')}}">Inventarios</a>
  <a class="breadcrumb-item" href="{{=URL('vehiculos')}}">Vehículos</a>
  <span class="breadcrumb-item active">{{=vehiculo['vh_marca']}} {{=vehiculo['vh_modelo']}} ({{=vehiculo['vh_placa']}})</span>
  </div>
</nav>
<!-- Fin del bloque de navegación secundaria (breadcrumb) -->


    {{ if request.vars.delete: }}
    <h3 class="dep-titulo text-center">VALIDACIÓN PENDIENTE</h3>
    {{pass}}
    <h3 class="dep-titulo text-center">{{=vehiculo['vh_marca']}} {{=vehiculo['vh_modelo']}} </h3>
    <h4 class="dep-titulo text-center">Año: {{=vehiculo['vh_ano']}}</h4>
    <h4 class="dep-titulo text-center">Placa: {{=vehiculo['vh_placa']}}</h4>
    <h4 class="dep-titulo text-center">Nº Bien Nacional: {{=vehiculo['vh_num']}}</h4>
    {{ if request.vars.delete: }}
        <h4 class="text-center">DESCRIPCIÓN DE LA ELIMINACIÓN: {{=vehiculo['vh_desc_eliminar'].upper()}}</h4>
    {{ pass }}

    <div class="w2p_flash alert alert-dismissable">{{=response.flash or ''}}</div>
{{pass}}


<!-- Inicio Boton Modificar VEHICULO -->
<div class="container" id="containerAgregar">
    <div class="row">
        <div class="col-sm-6"></div>
        <div id="columnBotonAgregar" class="col-sm-6">
            <div class="col-sm-6"></div>
            <div class="col-sm-6">
                {{ if request.vars.delete: }}
                <form method="post">
                    <!-- Boton para aceptar mod de bien mueble-->
                    <button type="button submit" name="si" value="True"><i class="fas fa-check fa-1x"></i></button>
                    <!--Boton para rechazar el bien mueble-->
                    <button type="button submit" name="no" value="True"><i class="fas fa-times fa-1x"></i></button>
                </form>
                {{ else: }}
                <!-- Boton que lleva al modal --> <!-- Cambiar data-target="#addservice por el id de la forma de la sustancia -->
                <button style="color:#fff;background-color: #337ab7;border-color: #2e6da4" type="button" data-toggle="modal" data-target="#addbm" onclick="select_values()"><i class="fas fa-pencil-alt fa-1x"></i></button>
                <!-- Boton para eliminar bien mueble-->
                <button style="color:#fff;background-color: #337ab7;border-color: #2e6da4" type="button" data-toggle="modal" data-target="#confirmdelete"><i class="fas fa-trash fa-1x"></i></button>
                {{ pass }}
            </div>
        </div>
    </div>
</div>
<br>
<!-- Fin Boton Agregar Sustancia -->

<!-- Ficha vehiculo aqui esta la infromacion del vehiculo -->
<div class="wrapper">
		
        <div class="tab-wrapper">
            <ul class="tabs">
                    <li class="tab-link active" data-tab="1"><br>CARACTERÍSTICAS</li>
                    <li class="tab-link" data-tab="2">RESPONSABILIDAD<br/>Y<br/>UBICACIÓN</li>
                    <li class="tab-link" data-tab="3"><br>SUDEBIP</li>
                    <li class="tab-link" data-tab="4">DATOS<br/>DE<br/>ADQUISICIÓN</li>
                    <li class="tab-link" data-tab="5">HISTORIAL DE MANTENIMIENTO</li>
                    <li class="tab-link" data-tab="6">HISTORIAL DE PRÉSTAMOS</li>
                </ul>
        </div>
    
        <div class="content-wrapper">
            <div id="tab-1" class="tab-content active">
                <div class="grid-container">
                    {{ for title in caracteristicas_list: }}
                        <div class="grid-item">
                            {{= title}}:
                        </div>
                        <div class="grid-item">
                            {{= caracteristicas_dict.get(title)}}
                        </div>
                    {{ pass }}
                </div>
            </div>   
   
            <div id="tab-2"class="tab-content">
              <div class="grid-container">
                <div class="grid-item">
                      Sede:
                </div>
                <div class="grid-item">
                       {{=db(db.sedes.id == vehiculo['vh_sede']).select().first().nombre}}
                </div>
                <div class="grid-item">
                      Dependencia:
                </div>
                <div class="grid-item">
                  {{=db(db.dependencias.id == vehiculo['vh_dependencia']).select().first().nombre}}
                </div>
                <div class="grid-item">
                      Responsable: 
                </div>
                <div class="grid-item">
                      {{=db(db.auth_user.id == vehiculo['vh_responsable']).select().first().first_name}} 
                      &nbsp;
                      {{=db(db.auth_user.id == vehiculo['vh_responsable']).select().first().last_name}}
                </div>
                <div class="grid-item">
                      Custodio: 
                </div>
                <div class="grid-item">
                      {{=db(db.auth_user.id == vehiculo['vh_custodio']).select().first().first_name}} 
                      &nbsp;
                      {{=db(db.auth_user.id == vehiculo['vh_custodio']).select().first().last_name}}
                </div>
                <div class="grid-item">
                      Ubicación de Custodio:
                </div>
                <div class="grid-item">
                       {{=vehiculo['vh_ubicacion_custodio']}}
                </div>
                {{ if vehiculo['vh_telf_custodio']: }}
                <div class="grid-item">
                      Tlf. de Custodio:
                </div>
                <div class="grid-item">
                       {{=vehiculo['vh_telf_custodio']}}
                </div>
                {{ pass }}
                {{ if vehiculo['vh_extension']: }}
                <div class="grid-item">
                      Extensión:
                </div>
                <div class="grid-item">
                        {{=vehiculo['vh_extension']}}
                </div>
                {{ pass }}
                <div class="grid-item">
                    Ubicación de pernocta:
                </div>
                <div class="grid-item">
                    {{=vehiculo['vh_lugar_pernocta']}}
                </div>
              </div>
            </div>

            <div id="tab-3"class="tab-content">
                <div class="grid-container">
                    <div class="grid-item">
                        Localización:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_sudebip_localizacion']}}
                    </div>
                    <div class="grid-item">
                        Código de Localización:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_sudebip_codigo_localizacion']}}
                    </div>
                    <div class="grid-item">
                        Categoría:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_sudebip_categoria']}}
                    </div>
                    <div class="grid-item">
                        Subcategoría:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_sudebip_subcategoria']}}
                    </div>
                    <div class="grid-item">
                        Categoría Específica:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_sudebip_categoria_especifica']}}
                    </div>
                </div>
            </div>

            <div id="tab-4"class="tab-content">
                <div class="grid-container">
                    <div class="grid-item">
                        Fecha de adquisición:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_fecha_adquisicion']}}
                    </div>
                    <div class="grid-item">
                        Origen:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_origen']}}
                    </div>
                    {{ if vehiculo['vh_origen'] == 'Compra': }}
                    <div class="grid-item">
                        Nº. Factura:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_nro_factura']}}
                    </div>
                    <div class="grid-item">
                        Fecha Factura:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_fecha_factura']}}
                    </div>
                    <div class="grid-item">
                        Proveedor:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_proveedor']}}
                    </div>
                    <div class="grid-item">
                        RIF:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_proveedor_rif']}}
                    </div>
                    {{ else: }}
                    <div class="grid-item">
                        Nº. Donación:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_nro_donacion']}}
                    </div>
                    <div class="grid-item">
                        Donante:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_donante']}}
                    </div>
                    <div class="grid-item">
                        Contacto:
                    </div>
                    <div class="grid-item">
                        {{=vehiculo['vh_contacto_donante']}}
                    </div>
                    {{ pass }}
                </div>
            </div>

            <div id="tab-5"class="tab-content">
                {{include 'inventarios/mantenimiento.html'}}
            </div>
            <div id="tab-6"class="tab-content">En desarrollo</div>

    
        </div>
        
    </div>

<!--Modal para eliminar Vehiculo-->
<div class="modal fade" id="confirmdelete" role="dialog">
    <div class="modal-dialog">
  
      <!-- Modal content-->
      <div class="modal-content">
  
        <!-- Modal Header -->
        <div class="modal-header addHeader">
          <div class="row addRow" id="rowHeader">
            <div class="col-sm-1" id="col1Header" style="background-color: red;">
              <div class="container">
                  <i class="fas fa-trash fa-2x" style="
                  display:block;
                  margin-left: -16px;
                  margin-top: 8px;
                  color: white;
                  "></i>
              </div>
            </div>
            <div class="col-sm-11" id="col11Header" style="background-color: red;">
              <h4 class="modal-title" id="nuevaBien" style="
                text-align: left;
                padding-top: 12px;
                color: white;
              ">Confirmar eliminación<button type="button" class="close" data-dismiss="modal">&times;</button>
              </h4>
            </div>
          </div>
        </div>
        <!-- Fin Modal Header -->
        
        <!-- Modal Body -->
        <div class="modal-body addBody">
            <br>
            <form method="post" style="text-align: center;">
                <div class="form-group">
                    <label>Descripción de eliminación*</label>
                    <input type="text" class="form-control" id="descripcion_eliminacion" name="descripcion_eliminacion" placeholder="Descripción de eliminación" required>
                    <div class="field-error"> <p id="error-est-eliminacion"> </p> </div>
                </div>
                <h4>¿Desea solicitar la eliminación de {{=vehiculo['vh_marca']}} {{=vehiculo['vh_modelo']}} con placa {{=vehiculo['vh_placa']}}?</h4>
                <br>
                <button type="submit button" class="btn btn-next botondelete" name="eliminacion" value="True" style="text-align:center">Si</button>
                <button type="button" class="btn btn-next botonForm" style="text-align:center" data-dismiss="modal">No</button>
            </form>
            <br>
        </div>
      </div>
    </div>
</div>

<!--Modal para oculta BM-->
<div class="modal fade" id="confirmhide" role="dialog">
        <div class="modal-dialog">
      
          <!-- Modal content-->
          <div class="modal-content">
      
            <!-- Modal Header -->
            <div class="modal-header addHeader">
              <div class="row addRow" id="rowHeader">
                <div class="col-sm-1" id="col1Header">
                  <div class="container">
                      <i class="fas fa-eye-slash fa-2x" style="
                      display:block;
                      margin-left: -19px;
                      margin-top: 12px;
                      color: white;
                      "></i>
                  </div>
                </div>
                <div class="col-sm-11" id="col11Header">
                  <h4 class="modal-title" id="nuevaBien" style="
                    text-align: left;
                    padding-top: 12px;
                    color: white;
                  ">Confirmar ocultar<button type="button" class="close" data-dismiss="modal">&times;</button>
                  </h4>
                </div>
              </div>
            </div>
            <!-- Fin Modal Header -->
            
            <!-- Modal Body -->
            <div class="modal-body addBody">
                <br>
                <form method="post" style="text-align: center;">
                    <h4>¿Desea ocultar o desocultar {{=vehiculo['vh_marca']}} {{=vehiculo['vh_modelo']}} de las consultas?</h4>
                    <br>
                    <button type="submit button" class="btn btn-next botondelete" name="ocultar" value="True" style="text-align:center">Si</button>
                    <button type="button" class="btn btn-next botonForm" style="text-align:center" data-dismiss="modal">No</button>
                </form>
                <br>
            </div>
          </div>
        </div>
    </div>

<!-- Modal añadir un BM nuevo al inventario -->
<div class="modal fade" id="addbm" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header addHeader">
        <div class="row addRow" id="rowHeader">
          <div class="col-sm-1" id="col1Header">
            <div class="container">
                <i class="fas fa-pencil-alt fa-2x" style="
                display:block;
                margin-left: -16px;
                margin-top: 8px;
                "></i>
            </div>
          </div>
          <div class="col-sm-11" id="col11Header">
            <h4 class="modal-title" id="nuevaBien" style="
              text-align: left;
              padding-top: 12px;
              color: white;
            ">Modificar Vehiculo<button type="button" class="close" data-dismiss="modal">&times;</button>
            </h4>
          </div>
        </div>
      </div>
      <!-- Fin Modal Header -->
      
      <!-- Modal Body -->
      <div class="modal-body addBody">
        <div class="row addRow">
          <div class="col-md-12 form-box">
              <form id="formularioCarga" class="registration-form" method="post">

            <!-- Primer paso-->
            <fieldset class="formField">
                <div class="form-bottom" data-step="1" data-title="Primer Paso">
                  <!-- Barra lateral gris (vacia en este caso, pues no hay pasos) -->
                  <div class="col-sm-1 col1Body"> 
                    <span class="step activePass">1</span>
                    <span class="step">2</span>
                    <span class="step">3</span>
                    <span class="step">4</span>
                    <span class="step">5</span>
                    <span class="step">6</span>
                    <span class="step">7</span>
                  </div>
                  <!-- Aqui va la informacion -->
                  <div class="col-sm-11 col11Body">
                    <h4 class="titulosForm">Características del vehículo</h4>       
                    <label>Campos marcados con * son obligatorios.</label>
                    <div class="form-group">
                        <label>Nº Bien Nacional*</label>
                        <input type="text" class="form-control" id="num" name="num" placeholder="Número de Bien Nacional*" title="Formato: ###### (6 dígitos)" required value="{{=vehiculo['vh_num']}}">
                        <div style="color: #d03e3e;" id="err_num" hidden></div>
                    </div>
                    <div class="form-group" tag="Formato:">
                        <label>Placa*</label>
                        <input type="text" class="form-control" id="placa" name="placa" title="Ingrese la placa del vehículo" placeholder="Placa*" required value="{{=vehiculo['vh_placa']}}">
                        <div class="dr" id="error-placa" style="color: #d03e3e;"> </div>
                    </div>
                    <div class="form-group" tag="Formato:">
                        <label>Marca*</label>
                        <select class="form-control" type="select" id="marca" name="marca" placeholder="Ingrese la marca del vehículo" required>
                            <option value="">Seleccione una opción</option>
                            <option value="Chevrolet">Chevrolet</option>
                            <option value="Citroen">Citroen</option>
                            <option value="Fiat">Fiat</option>
                            <option value="Ford">Ford</option>
                            <option value="Honda">Honda</option>
                            <option value="Iveco">Iveco</option>
                            <option value="Jeep">Jeep</option>
                            <option value="Kia">Kia</option>
                            <option value="Mazda">Mazda</option>
                            <option value="Mercedes-Benz">Mercedes-Benz</option>
                            <option value="Mitsubishi">Mitsubishi</option>
                            <option value="Nissan">Nissan</option>
                            <option value="Peugeot">Peugeot</option>
                            <option value="Renault">Renault</option>
                            <option value="Sert">Sert</option>
                            <option value="Subaru">Subaru</option>
                            <option value="Suzuki">Suzuki</option>
                            <option value="Tesla">Tesla</option>
                            <option value="Toyota">Toyota</option>
                            <option value="Volkswagen">Volkswagen</option>
                            <option value="Volvo">Volvo</option>
                            <option value="Otro">Otro</option>
                        </select>
                        <input type="text" class="form-control" id="marca2" name="marca2" title="Ingrese la marca del vehículo" placeholder="Especifique" disabled style="display:none;">
                        <div class="dr" id="error-marca" style="color: #d03e3e;"> </div>
                    </div>
                    <div class="form-group" tag="Formato:">
                        <label>Modelo / Código*</label>
                        <input type="text" class="form-control" id="modelo" name="modelo" title="Ingrese el modelo del vehículo" placeholder="Modelo*" required value="{{=vehiculo['vh_modelo']}}">
                        <div class="dr" id="error-marca" style="color: #d03e3e;"> </div>
                    </div>
                    <div class="form-group" tag="Formato:">
                        <label>Año*</label>
                        <input type="text" class="form-control" id="ano" name="ano" title="Ingrese el año del vehículo" placeholder="Año*" required value="{{=vehiculo['vh_ano']}}">
                        <div class="dr" id="error-ano" style="color: #d03e3e;"> </div>
                    </div>
                    <div class="form-group" tag="Formato:">
                        <label>Color</label>
                        <input type="text" class="form-control" id="color" name="color" title="Ingrese el color del vehículo" placeholder="Color" value="{{=vehiculo['vh_color']}}">
                        <div class="dr" id="error-color" style="color: #d03e3e;"> </div>
                    </div>  
                    
                  </div>
                </div>
                <div style="position:fixed; bottom: 15px; right: 30px;">
                  <button type="button" class="btn btn-next botonForm"><i class="fas fa-arrow-right"></i></button>
                </div>
              </fieldset>
          
                <!-- Segundo paso-->
                <fieldset class="formField">
                  <div class="form-bottom" data-step="2" data-title="Segundo Paso">
                    <!-- Barra lateral gris (vacia en este caso, pues no hay pasos) -->
                    <div class="col-sm-1 col1Body"> 
                      <span class="step">1</span>
                      <span class="step activePass">2</span>
                      <span class="step">3</span>
                      <span class="step">4</span>
                      <span class="step">5</span>
                      <span class="step">6</span>
                      <span class="step">7</span>
                    </div>
                    <!-- Aqui va la informacion -->
                    <div class="col-sm-11 col11Body">
                      <h4 class="titulosForm">Características del Vehículo</h4>                
                      <label>Campos marcados con * son obligatorios.</label>
                        <div class="form-group" tag="Formato:">
                            <label>Serial de carrocería*</label>
                            <input type="text" class="form-control" id="serialC" name="serialC" title="Ingrese el serial de carrocería del vehículo" placeholder="Serial de carrocería*" required value="{{=vehiculo['vh_serial_carroceria']}}">
                            <div class="dr" id="error-serialc" style="color: #d03e3e;"> </div>
                        </div>

                        <div class="form-group" tag="Formato:">
                            <label>Serial del motor*</label>
                            <input type="text" class="form-control" id="serialM" name="serialM" title="Ingrese el serial del motor del vehículo" placeholder="Serial del motor*" required value="{{=vehiculo['vh_serial_motor']}}">
                            <div class="dr" id="error-serialm" style="color: #d03e3e;"> </div>
                        </div>

                        <div class="form-group" tag="Formato:">
                            <label>Serial del chasis*</label>
                            <input type="text" class="form-control" id="serialCh" name="serialCh" title="Ingrese el serial del chasis del vehículo" placeholder="Serial del chasis*" required value="{{=vehiculo['vh_serial_chasis']}}">
                            <div class="dr" id="error-serialch" style="color: #d03e3e;"> </div>
                        </div>

                        <div class="form-group">
                            <label>Nº de Autorización INTT*</label>
                            <input type="text" class="form-control" id="intt" name="intt" placeholder="Nº de Autorización INTT*" title="Ingrese el Nº de Autorización INTT"  required value="{{=vehiculo['vh_intt']}}">
                            <div class="dr" id="error-intt" style="color: #d03e3e;"> </div>
                        </div>

                        <div class="form-group campo-oculto">
                          <label>Sede*</label> <br>
                          <input type="text" class="form-control" id="sede" name="sede" placeholder="Sede*" title="Ingrese la Sede" disabled value="{{= db(db.sedes.id == sede_id).select().first().nombre }}">
                          <div class="dr" id="error-sede" style="color: #d03e3e;"> </div>
                        </div>

                    </div>
                  </div>
                  <div style="position:fixed; bottom: 15px; right: 30px;">
                    <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                    <button type="button"  class="btn btn-next botonForm"><i class="fas fa-arrow-right"></i></button>
                  </div>
                </fieldset>
                <!-- Fin Segundo Paso -->     

                <!-- Tercer paso -->
                <fieldset class="formField">
                  <div class="form-bottom" data-step="3" data-title="Tercer Paso">
                    <!-- Barra lateral gris (vacia en este caso, pues no hay pasos) -->
                    <div class="col-sm-1 col1Body"> 
                      <span class="step">1</span>
                      <span class="step">2</span>
                      <span class="step activePass">3</span>
                      <span class="step">4</span>
                      <span class="step">5</span>
                      <span class="step">6</span>
                      <span class="step">7</span>
                    </div>
                    <!-- Aqui va la informacion -->
                    <div class="col-sm-11 col11Body">
                      <h4 class="titulosForm">Características del Vehículo</h4>                
                      <label>Campos marcados con * son obligatorios.</label>
                      <div class="form-group" tag="Formato:">
                          <label>Clase*</label>
                          <select class="form-control" type="select" id="clase" name="clase" placeholder="Clase*" required>
                            <option value="">Seleccione una opción</option>
                            <option value="No motorizados o de tracción a sangre">No motorizados o de tracción a sangre</option>
                            <option value="A motor">A motor</option>
                            <option value="Maquinarias y aparatos aptos para circular">Maquinarias y aparatos aptos para circular</option>
                        </select>
                          <div class="dr" id="error-clase" style="color: #d03e3e;"> </div>
                      </div>

                      <div class="form-group" tag="Formato:">
                          <label>Tipo*</label>
                          <select class="form-control" type="select" id="tipo" name="tipo" placeholder="Tipo*" required>
                            <option value="">Seleccione una opción</option>
                            <option value="Motocicleta">Motocicleta</option>
                            <option value="Automóvil">Automóvil</option>
                            <option value="Minibús">Minibús</option>
                            <option value="Autobús">Autobús</option>
                            <option value="Vehículos de carga">Vehículos de carga</option>
                            <option value="Vehículos especiales">Vehículos especiales</option>
                            <option value="Otros aparatos para circular">Otros aparatos para circular</option>
                        </select>
                        <input type="text" class="form-control" id="tipo2" name="tipo2" title="Ingrese la marca del vehículo" placeholder="Especifique" disabled style="display:none;">
                          <div class="dr" id="error-clase" style="color: #d03e3e;"> </div>
                      </div>

                      <div class="form-group" id="grupo-clasificacion" style="display: none;">
                          <label>Clasificación*</label>
                          <select class="form-control" type="select" id="clasificacion" name="clasificacion" placeholder="Clasificación*">
                              <option value="">Seleccione una opción</option>
                          </select>
                          <select class="form-control" type="select" id="clasificacion2" name="clasificacion2" disabled style="display: none;">
                              <option value="">Seleccione una opción</option>
                              <option value="Vehículos policiales">Vehículos policiales</option>
                              <option value="Vehículos militares">Vehículos militares</option>
                              <option value="Ambulancias">Ambulancias</option>
                              <option value="Bomberos">Bomberos</option>
                              <option value="Forenses">Forenses</option>
                          </select>
                          <div class="dr" id="error-uso" style="color: #d03e3e;"> </div>
                      </div>

                        <div class="form-group">
                            <label>Uso*</label>
                            <select class="form-control" type="select" id="uso" name="uso" placeholder="Uso*" required>
                                <option value="">Seleccione una opción</option>
                                <option value="Público">Público</option>
                                <option value="Privado">Privado</option>
                            </select>
                            <div class="dr" id="error-uso" style="color: #d03e3e;"> </div>
                        </div>

                        <div class="form-group">
                            <label>Servicio*</label>
                            <select class="form-control" type="select" id="servicio" name="servicio" placeholder="Servicio*" required>
                                <option value="">Seleccione una opción</option>
                                <option value="Transporte terrestre de personas">Transporte terrestre de personas</option>
                                <option value="Transporte terrestre de cargas">Transporte terrestre de cargas</option>
                                <option value="Servicios conexos">Servicios conexos</option>
                            </select>
                            <div class="dr" id="error-servicio" style="color: #d03e3e;"> </div>
                        </div>

                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                              <label>Tara*</label>
                              <input type="text" class="form-control"  id="tara" name="tara" placeholder="Tara*" required value="{{=vehiculo['vh_tara']}}">
                              <div class="dr" id="error-tara" style="color: #d03e3e;"> </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group">
                              <label>Unidad de medida Tara*</label>
                              <select class="form-control" type="select" id="tara_md" name="tara_md" placeholder="Unidad de medida Tara" required>
                                  <option value="">Seleccione una opción</option>
                                  <option value="ton">Toneladas (ton)</option>
                                  <option value="kg">Kilogramos (kg)</option>
                              </select>
                              <div class="dr" id="error-tara_md" style="color: #d03e3e;"> </div>
                            </div>
                          </div>
                        </div>

                      </div>
                  </div>
                  <div style="position:fixed; bottom: 15px; right: 30px;">
                    <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                    <button type="button" class="btn btn-next botonForm"><i class="fas fa-arrow-right"></i></button>       
                  </div>
              </fieldset>
                <!-- Fin Tercer Paso -->

                <!-- Comienzo Cuarto Paso -->
                <fieldset class="formField">
                    <div class="form-bottom" data-step="4" data-title="Cuarto Paso">
                      <!-- Aqui va la barra lateral -->
                      <div class="col-sm-1 col1Body">
                        <span class="step">1</span>
                        <span class="step">2</span>
                        <span class="step">3</span>
                        <span class="step activePass">4</span>
                        <span class="step">5</span>
                        <span class="step">6</span>
                        <span class="step">7</span>
                      </div>
  
                      <!-- Aqui va la informacion -->
                      <div class="col-sm-11 col11Body">
                        <h4 class="titulosForm">Características del Vehículo</h4>
                        <label>Campos marcados con * son obligatorios.</label>
                        <div class="form-group">
                            <label>N° de puestos*</label>
                            <input type="text" class="form-control" id="nro_puestos" name="nro_puestos" title="Ingrese el N° de puestos del vehículo" placeholder="N° de puestos" value="{{=vehiculo['vh_nro_puestos']}}">
                            <div class="dr" id="error-nro_puestos" style="color: #d03e3e;"> </div>
                            <!-- <div style="color: #d03e3e;" id="err_nro_puestos" hidden></div> -->
                        </div>

                        <div class="form-group">
                            <label>N° de ejes*</label>
                            <input type="text" class="form-control" id="nro_ejes" name="nro_ejes" title="Ingrese el N° de ejes del vehículo" placeholder="N° de ejes" value="{{=vehiculo['vh_nro_ejes']}}">
                            <div class="dr" id="error-nro_ejes" style="color: #d03e3e;"> </div>
                            <!-- <div style="color: #d03e3e;" id="err_nro_puestos" hidden></div> -->
                        </div>

                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group">
                              <label>Capacidad de carga*</label>
                              <input type="text" class="form-control" id="capacidad" name="capacidad" placeholder="Capacidad de carga*" title="Ingrese la capacidad de carga del vehículo"  required value="{{=vehiculo['vh_capacidad_carga']}}">
                              <div class="dr" id="error-carga" style="color: #d03e3e;"> </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="form-group">
                            <label>Unidad de medida Cap. Carga*</label>
                            <select class="form-control" type="select" id="capacidad_carga_md" name="capacidad_carga_md" placeholder="Unidad de medida Capacidad de Carga" required>
                                <option value="">Seleccione una opción</option>
                                <option value="ton">Toneladas (ton)</option>
                                <option value="kg">Kilogramos (kg)</option>
                            </select>
                            <div class="dr" id="error-capacidad_carga_md" style="color: #d03e3e;"> </div>
                          </div>
                        </div>
                      </div>

                      <div class="form-group">
                          <label>Rines</label>
                          <select class="form-control" type="select" name="rines" id="rines" class="input">
                            <option value="">Seleccione una opción</option>
                            <option value="Acero">Acero</option>
                            <option value="Hierro">Hierro</option>
                            <option value="Magnesio">Magnesio</option>
                            <option value="Otro">Otro</option>
                          </select>
                          <input type="text" class="form-control" id="rines2" name="rines2" title="Ingrese los rines del vehículo" placeholder="Especifique" disabled style="display:none;">
                          <div class="dr" id="error-rines" style="color: #d03e3e;"> </div>
                      </div>

                      <div class="form-group">
                          <label>Observaciones</label>
                          <input type="text" class="form-control" id="observaciones" name="observaciones" placeholder="Indicar cualquier otra información relevante" title="Indicar cualquier otra información relevante" value="{{=vehiculo['vh_observaciones']}}">
                          <div class="dr" id="error-observaciones" style="color: #d03e3e;"> </div>
                      </div>

                    </div>
                  </div>
                  <div style="position:fixed; bottom: 15px; right: 30px;">
                    <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                    <button type="button" class="btn btn-next botonForm"><i class="fas fa-arrow-right"></i></button>
                  </div>
              </fieldset>

                <!-- Quinto Paso -->
                <fieldset class="formField">
                    <div class="form-bottom" data-step="5" data-title="Quinto Paso">
                      <!-- Barra lateral gris (vacia en este caso, pues no hay pasos) -->
                      <div class="col-sm-1 col1Body"> 
                        <span class="step">1</span>
                        <span class="step">2</span>
                        <span class="step">3</span>
                        <span class="step">4</span>
                        <span class="step activePass">5</span>
                        <span class="step">6</span>
                        <span class="step">7</span>
                      </div>
                      <!-- Aqui va la informacion -->
                      <div class="col-sm-11 col11Body">
                        <h4 class="titulosForm">Ubicacion y responsable del Vehículo</h4>                
                        <label>Campos marcados con * son obligatorios.</label>
                        <div class="form-group">
                            <label>Nombre del propietario*</label>
                            <input type="text" class="form-control" id="propietario" name="propietario" placeholder="Nombre del propietario*" title="Ingrese el nombre del propietario del vehículo" required value="{{=vehiculo['vh_propietario']}}">
                            <div class="dr" id="error-propietario" style="color: #d03e3e;"> </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Responsable*</label>
                            <select class="form-control" type="select" name="responsable" id="responsable" class="input" required>
                              <option value="">Seleccione una opción</option>
                              {{for usuario in db(db.auth_user).select() :}}
                                <option id="{{=usuario.id}}" value="{{=usuario.id}}" {{ if vehiculo['vh_responsable'] == usuario.id: }}selected{{ pass }}>{{=usuario.first_name}} {{=usuario.last_name }}</option>
                              {{pass}}
                            </select>
                            <div class="dr" id="error-responsable" style="color: #d03e3e;"> </div>
                        </div>
                    
                        <div class="form-group">
                            <label>Custodio del vehículo*</label>
                            <select class="form-control" type="select" name="custodio" id="custodio" class="input" required>
                              <option value="">Seleccione una opción</option>
                              {{for usuario in db(db.auth_user).select() :}}
                                <option id="{{=usuario.id}}" value="{{=usuario.id}}" {{ if vehiculo['vh_custodio'] == usuario.id: }}selected{{ pass }}>{{=usuario.first_name}} {{=usuario.last_name }}</option>
                              {{pass}}
                            </select>
                            <div class="dr" id="error-custodio" style="color: #d03e3e;"> </div>
                        </div>

                        <div class="form-group">
                            <label>Ubicación del custodio*</label>
                            <input type="text" class="form-control" id="ubicacion_custodio" name="ubicacion_custodio" placeholder="Ubicación del custodio*" title="Ingrese la ubicación del custodio del vehículo" required value="{{=vehiculo['vh_ubicacion_custodio']}}">
                            <div class="dr" id="error-ubicacion_custodio" style="color: #d03e3e;"> </div>
                        </div>

                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                                <label>Telefono del custodio</label>
                                <input type="text" class="form-control" id="telf_custodio" name="telf_custodio" placeholder="Telefono del custodio" title="Ingrese el teléfono del custodio del vehículo" value="{{=vehiculo['vh_telf_custodio']}}">
                                <div class="dr" id="error-telf_custodio" style="color: #d03e3e;"> </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group">
                                <label>Extensión</label>
                                <input type="text" class="form-control" id="extension" name="extension" placeholder="Extensión" title="Ingrese el teléfono del custodio del vehículo"  
                                {{ if vehiculo['vh_extension'] != None : }} value="{{=vehiculo['vh_extension']}}" {{pass}} >
                                <div class="dr" id="error-extension" style="color: #d03e3e;"> </div>
                            </div>
                          </div>
                        </div>

                        <div class="form-group">
                            <label>Ubicacion de pernocta*</label>
                            <input type="text" class="form-control" id="pernocta" name="pernocta" placeholder="Ubicacion de pernocta*" title="Ingrese la ubicacion de pernocta del vehículo" required value="{{=vehiculo['vh_ubicacion_custodio']}}">
                            <div class="dr" id="error-pernocta" style="color: #d03e3e;"> </div>
                        </div>
                      </div>
                    </div>
                    <div style="position:fixed; bottom: 15px; right: 30px;">
                      <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                      <button type="button" class="btn btn-next botonForm"><i class="fas fa-arrow-right"></i></button>       
                    </div>
                </fieldset>
                <!-- Fin Quinto Paso -->

                <!-- Comienzo Sexto Paso -->
                <fieldset class="formField">
                    <div class="form-bottom" data-step="6" data-title="Sexto Paso">
                      <!-- Aqui va la barra lateral -->
                      <div class="col-sm-1 col1Body">
                        <span class="step">1</span>
                        <span class="step">2</span>
                        <span class="step">3</span>
                        <span class="step">4</span>
                        <span class="step">5</span>
                        <span class="step activePass">6</span>
                        <span class="step">7</span>
                      </div>
  
                      <!-- Aqui va la informacion -->
                      <div class="col-sm-11 col11Body">
                        <h4 class="titulosForm">SUDEBIP</h4>
                        <label>Importante: llene según requerimientos de SUDEBIP</label>
                        <div class="form-group">
                            <label>Localización*</label>
                            <input type="text" class="form-control" id="sudebip_localizacion" name="sudebip_localizacion" placeholder="Localización*" title="Ingrese la localizacion vehículo" disabled value="{{=vehiculo['vh_sudebip_localizacion']}}">
                        </div>
                        <div class="form-group">
                            <label>Código de Localización*</label>
                            <input type="text" class="form-control" id="sudebip_cod_localizacion" name="sudebip_cod_localizacion" placeholder="Código de Localización*" title="Ingrese el código de localización del vehículo" disabled value="{{=vehiculo['vh_sudebip_codigo_localizacion']}}">
                        </div>
                        <div class="form-group">
                            <label>Categoría*</label>
                            <input type="text" class="form-control" id="sudebip_categoria" name="sudebip_categoria" placeholder="Categoría*" title="Ingrese la categoría vehículo" value="15000-0000 - Equipos de transporte, tracción y elevación" disabled value="{{=vehiculo['vh_sudebip_categoria']}}">
                        </div>
                        <div class="form-group">
                            <label>Subcategoría*</label>
                            <select class="form-control" type="select" id="sudebip_subcategoria" name="sudebip_subcategoria" placeholder="Subcategoría*" title="Ingrese la subcategoría del vehículo" required>
                                <option value="">Seleccione una opción</option>
                                {{ for subcat, _ in categorias.items(): }}
                                <option value="{{=subcat}}" {{ if vehiculo['vh_sudebip_subcategoria'] == subcat: }}selected{{ pass }}>{{=subcat}}</option>
                                {{ pass }}
                            </select>
                            <div class="dr" id="error-sudebip_subcategoria" style="color: #d03e3e;"> </div>
                        </div>
                        <div class="form-group" id="grupo-catesp" style="display: none;">
                            <label>Categoría específica*</label>
                            <select class="form-control" type="select" id="sudebip_categoria_especifica" name="sudebip_categoria_especifica" placeholder="Categoría específica*" title="Ingrese la categoría específica del vehículo" required>
                              <option value="">Seleccione una opción</option>
                            </select>
                            <div class="dr" id="error-categoria_específica" style="color: #d03e3e;"> </div>
                        </div>
                      </div>
                    </div>
                    <div style="position:fixed; bottom: 15px; right: 30px;">
                      <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                      <button type="button" class="btn btn-next botonForm"><i class="fas fa-arrow-right"></i></button>
                    </div>
                </fieldset>
                <!-- Fin Sexto Paso -->

                <!-- Comienzo Séptimo Paso -->
                <fieldset class="formField">
                    <div class="form-bottom" data-step="7" data-title="Séptimo Paso">
                      <!-- Aqui va la barra lateral -->
                      <div class="col-sm-1 col1Body">
                        <span class="step">1</span>
                        <span class="step">2</span>
                        <span class="step">3</span>
                        <span class="step">4</span>
                        <span class="step">5</span>
                        <span class="step">6</span>
                        <span class="step activePass">7</span>
                      </div>
                      <!-- Aqui va la informacion -->
                      <div class="col-sm-11 col11Body">
                        <h4 class="titulosForm">Datos de adquisición</h4>
                        <label>Campos marcados con * son obligatorios.</label>
                        <div class="form-group">
                            <label>Fecha de adquisición*</label>
                            <input type="date" class="form-control" id="fecha_adquisicion" name="fecha_adquisicion" placeholder="Fecha de adquisición*" title="Ingrese la fecha de adquisición vehículo" required value="{{=vehiculo['vh_fecha_adquisicion']}}" min="1967-07-18">
                            <div class="dr" id="error-fecha_adquisicion" style="color: #d03e3e;"> </div>
                        </div>
                        <div class="form-group">
                            <label>Origen*</label>
                            <select class="form-control" type="select" id="origen" name="origen" placeholder="Origen*" required>
                                <option value="">Seleccione una opción</option>
                                <option value="Compra">Compra</option>
                                <option value="Donación">Donación</option>
                            </select>
                            <div class="dr" id="error-origen" style="color: #d03e3e;"> </div>
                        </div>
                        <div id="grupo-compra" style="display: none;">
                          <div class="form-group">
                              <label>Nro Factura*</label>
                              <input type="text" class="form-control" id="nro_factura" name="nro_factura" placeholder="Nro Factura*" title="Ingrese el Nro de Factura" value="{{=vehiculo['vh_nro_factura']}}">
                              <div class="dr" id="error-nro_factura" style="color: #d03e3e;"> </div>
                          </div>
                          <div class="form-group">
                              <label>Fecha de factura*</label>
                              <input type="date" class="form-control" id="fecha_factura" name="fecha_factura" placeholder="Fecha de factura*" title="Ingrese la fecha de factura" value="{{=vehiculo['vh_fecha_factura']}}">
                              <div class="dr" id="error-fecha_factura" style="color: #d03e3e;"> </div>
                          </div>
                          <div class="form-group">
                              <label>Proveedor*</label>
                              <input type="text" class="form-control" id="proveedor" name="proveedor" placeholder="Proveedor*" title="Ingrese el proveedor del vehículo" value="{{=vehiculo['vh_proveedor']}}">
                              <div class="dr" id="error-proveedor" style="color: #d03e3e;"> </div>
                          </div>
                          <div class="form-group">
                              <label>RIF*</label>
                              <input type="text" class="form-control" id="proveedor_rif" name="proveedor_rif" placeholder="RIF*" title="Ingrese el RIF" value="{{=vehiculo['vh_proveedor_rif']}}">
                              <div class="dr" id="error-rif" style="color: #d03e3e;"> </div>
                          </div>
                        </div>
                        <div id="grupo-donacion" style="display: none;">
                          <div class="form-group">
                              <label>Nº Oficio*</label>
                              <input type="text" class="form-control" id="nro_oficio" name="nro_oficio" placeholder="Nro oficio*" title="Ingrese el Nro de oficio" value="{{=vehiculo['vh_nro_oficio']}}">
                              <div class="dr" id="error-nro_oficio" style="color: #d03e3e;"> </div>
                          </div>
                          <div class="form-group">
                              <label>Donante*</label>
                              <input type="text" class="form-control" id="donante" name="donante" placeholder="Donante*" title="Ingrese el Donante" value="{{=vehiculo['vh_donante']}}">
                              <div class="dr" id="error-donante" style="color: #d03e3e;"> </div>
                          </div>
                          <div class="form-group">
                              <label>Teléfono del Donante*</label>
                              <input type="text" class="form-control" id="contacto_donante" name="contacto_donante" placeholder="Teléfono del Donante*" title="Ingrese el telefono del Donante" value="{{=vehiculo['vh_contacto_donante']}}">
                              <div class="dr" id="error-contacto_donante" style="color: #d03e3e;"> </div>
                          </div>
                        </div>
                    </div>
                  </div>
                  <input type="hidden" name="modificacion" id="modificacion" value="True">
                  <div style="position:fixed; bottom: 15px; right: 30px;">
                    <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                    <button type="submit button" form="formularioCarga" id="submit" class="btn btn-submit botonForm"><i class="fas fa-plus"></i></button>             
                  </div>
              </fieldset>
                <!-- Fin Séptimo Paso -->
              </form>
          </div>
        </div>               
      </div>
    </div>
  </div>
</div>

<!-- Fin Modal Agregar BM -->

      
      <!-- Fin Modal Agregar Mantenimiento -->

<script type="text/javascript">
  var categorias_sudebip = {};
  var clasificaciones = {};
  var regexTlf = new RegExp("^[(]{1}[0]{1}[0-9]{3}[)]{1}[\ ]{1}[0-9]{3}-[0-9]{4}$");
  var regexExtension = new RegExp("^[0-9]{4}$");

  function isNum(str) {
    return !isNaN(str);
  }

  // Validación de bien mueble
  $("#num").focusout(function() {
    var num = $(this).val();
    if (isNum(num) && num.length == 6) {
      $(this).next().hide();
      $(this).css('border-color', '#ddd');
      $(this).css('color', '#888');
    }
    else {
      $(this).css('border-color', '#d03e3e');
      $(this).next().show();
      $(this).next().text("Introduce un número de 6 dígitos");
    }
  });

  // Validación de serial de carrocería (17 dígitos)
  $("#serialCh").focusout(function() {
    var serial = $(this).val();
    if (serial.length == 17) {
      $(this).next().hide();
      $(this).css('border-color', '#ddd');
      $(this).css('color', '#888');
    }
    else {
      $(this).css('border-color', '#d03e3e');
      $(this).next().show();
      $(this).next().text("Introduce un serial de 17 dígitos");
    }
  });

  // Validación de formato de puestos (2 dígitos)
  $("#nro_puestos").focusout(function() {
    var nro_puestos = $(this).val();
    if (nro_puestos.length == 1 || nro_puestos.length == 2) {
      $(this).next().hide();
      $(this).css('border-color', '#ddd');
      $(this).css('color', '#888');
    }
    else {
      $(this).css('border-color', '#d03e3e');
      $(this).next().show();
      $(this).next().text("Introduce número en formato de uno o dos dígitos: # ó ##");
    }
  });

  // Validación de formato de año (####)
  $("#ano").focusout(function() {
    var ano = $(this).val();
    if (ano.length == 4) {
      var numeric_ano = parseInt(ano);
      if (numeric_ano >= 1960) {
        var max_ano = (new Date()).getFullYear();
        if (numeric_ano <= max_ano) {
          $(this).next().hide();
          $(this).css('border-color', '#ddd');
          $(this).css('color', '#888');
        } else {
          $(this).css('border-color', '#d03e3e');
          $(this).next().show();
          $(this).next().text("Introduce año menor o igual al año en curso");
        }
      } else {
        $(this).css('border-color', '#d03e3e');
        $(this).next().show();
        $(this).next().text("Introduce año mayor o igual a 1960");
      }
    } else {
      $(this).css('border-color', '#d03e3e');
      $(this).next().show();
      $(this).next().text("Introduce año en formato de cuatro dígitos: ####");
    }
  });

  // Validación de formato de telf custodio (formato del regex establecido)
  $("#telf_custodio").focusout(function() {
    var tlf = $(this).val();
    if (regexTlf.test(tlf) || tlf.length == 0) {
      $(this).next().hide();
      $(this).css('border-color', '#ddd');
      $(this).css('color', '#888');
    }
    else if (tlf.length != 0) {
      $(this).css('border-color', '#d03e3e');
      $(this).next().show();
      $(this).next().text("Formato: (0###) ###-####");
    }
  });

  // Máscara js para formato de teléfono
  $(document).ready(function() {
    $('#telf_custodio').mask('(0000) 000-0000');
  }

  // Validación de formato de extension custodio (formato del regex establecido)
  $("#extension").focusout(function() {
    var extension = $(this).val();
    if (regexExtension.test(extension) || extension.length == 0) {
      $(this).next().hide();
      $(this).css('border-color', '#ddd');
      $(this).css('color', '#888');
    }
    else if (extension.length != 0) {
      $(this).css('border-color', '#d03e3e');
      $(this).next().show();
      $(this).next().text("Formato: ####");
    }
  });


  // Validación de campos requeridos y no llenados
  // (ignora el resto de campos especiales)
  $("input[required]").focusout(function() {
    var value = $(this).val();

    if (   !$(this).is("#num") 
        && !$(this).is("#serialCh")
        && !$(this).is("#nro_puestos")
        && !$(this).is("#ano")
       ) {
      if (value.length == 0) {
        $(this).css('border-color', '#d03e3e');
        $(this).next().show();
        $(this).next().text("Este campo es obligatorio.");
      } else {
        $(this).next().hide();
        $(this).css('border-color', '#ddd');
        $(this).css('color', '#888');
      }
    }
  });

  // Carga las categorias de sudebip
  $(document).ready(function() {
    {{ for subcat, lista_cat_esp in categorias.items(): }}
      categorias_sudebip["{{=subcat}}"] = [
        {{ for cat_esp in lista_cat_esp: }}
          "{{=cat_esp}}",
        {{ pass }}
        ];
    {{ pass }}

    {{ for tipo, lista_clasif in clasificaciones.items(): }}
      clasificaciones["{{=tipo}}"] = [
        {{ for clasif in lista_clasif: }}
          "{{=clasif}}",
        {{ pass }}
        ];
    {{ pass }}
  });

  // Valida la fecha del selector de fecha adquisición
  $(document).ready(function() {
    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();

    var maximo = yyyy + "-" + mm + "-" + dd;

    $("#fecha_adquisicion").attr('max', maximo);
  });

  // Verifica la fecha introducida
  $("#fecha_adquisicion").change(function() {
    var fecha = new Date($(this).val());
    var maximo = new Date();
    var minimo = new Date("1967-07-18");

    if ((minimo <= fecha) && (fecha <= maximo)) {
      $(this).next().hide();
      $(this).css('border-color', '#ddd');
      $(this).css('color', '#888');
    } else {
      $(this).css('border-color', '#d03e3e');
      $(this).css('color', '#d03e3e');
      $(this).next().show();
      $(this).next().text("Introduce una fecha válida.");
    }
  });
  
  // Actualiza selector de categorias sudebip 
  $("#sudebip_subcategoria").change(function() {
    var subcat = $(this).children("option:selected").val();
    $("#grupo-catesp").show("fast");
    $('#sudebip_categoria_especifica option:gt(0)').remove(); 

    var longitud = categorias_sudebip[subcat].length;
    for (var i = 0; i < longitud; i++) {
      $("#sudebip_categoria_especifica").append(
        $("<option></option>").attr("value", categorias_sudebip[subcat][i]).text(categorias_sudebip[subcat][i])
      );
    }

    if (subcat == "") {
      $("#grupo-catesp").hide("fast");
    }

  });

  // Actualiza selector de clasificaciones por tipo
  $("#tipo").change(function() {
    var tipo = $(this).children("option:selected").val();

    if (tipo == "Otros aparatos para circular") {
      $("#grupo-clasificacion").prop('disabled', true);
      $("#grupo-clasificacion").prop('required', false);
      $("#grupo-clasificacion").hide("fast");
    } else {
      $("#grupo-clasificacion").show("fast");
      $("#grupo-clasificacion").prop('disabled', false)
      $("#grupo-clasificacion").prop('required', true)
      $('#clasificacion option:gt(0)').remove(); 

      var longitud = clasificaciones[tipo].length;
      for (var i = 0; i < longitud; i++) {
        $("#clasificacion").append(
          $("<option></option>").attr("value", clasificaciones[tipo][i]).text(clasificaciones[tipo][i])
        );
      }
    }
  });

  // Mostrar datos de compra o donacion según lo escogido
  $("#origen").change(function() {
    var origen = $(this).children("option:selected").val();
    if (origen == "Compra") {
      $("#grupo-compra").show("fast");
      $("#grupo-donacion").hide("fast");
    } else if (origen == "Donación") {
      $("#grupo-compra").hide("fast");
      $("#grupo-donacion").show("fast");
    } else {
      $("#grupo-compra").hide("fast");
      $("#grupo-donacion").hide("fast");
    }
  });

  // Marca otro
  $("#marca").change(function() {
    var marca = $(this).children("option:selected").val();
    if (marca == "Otro") {
      $("#marca2").show("fast");
      $("#marca2").prop('disabled', false)
      $("#marca2").prop('required', true)
    } else {
      $("#marca2").hide();
      $("#marca2").prop('disabled', true)
      $("#marca2").prop('required', false)
    }
  });

  $("#clasificacion").change(function() {
    var clasificacion = $(this).children("option:selected").val();
    if (clasificacion == "Emergencia") {
      $("#clasificacion2").show("fast");
      $("#clasificacion2").prop('disabled', false)
      $("#clasificacion2").prop('required', true)
    } else {
      $("#clasificacion2").hide();
      $("#clasificacion2").prop('disabled', true)
      $("#clasificacion2").prop('required', false)
    }
  });

  $("#tipo").change(function() {
    var tipo = $(this).children("option:selected").val();
    if (tipo == "Otros aparatos para circular") {
      $("#tipo2").show("fast");
      $("#tipo2").prop('disabled', false)
    } else {
      $("#tipo2").hide();
      $("#tipo2").prop('disabled', true)
    }
  });

  $("#rines").change(function() {
    var rines = $(this).children("option:selected").val();
    if (rines == "Otro") {
      $("#rines2").show("fast");
      $("#rines2").prop('disabled', false)
      $("#rines2").prop('required', true)
    } else {
      $("#rines2").hide();
      $("#rines2").prop('required', false)
      $("#rines2").prop('disabled', true)
    }
  });

  // Dropdown origen no vacío
  $(".btn-submit").click(function() {
    var origen = $("#origen").children("option:selected").val();
    if (origen.length == 0) {
      $("#origen").css('border-color', '#d03e3e');
      $("#origen").next().show();
      $("#origen").next().text("Selecciona un origen de adquisición para el vehículo.");
    } else {
      $("#origen").css('border-color', '#ddd');
      $("#origen").css('color', '#888');
      $("#origen").next().hide();
    }
  });

  // Dropdown origen no vacío, parte 2
  $("#origen").change(function() {
    var origen = $("#origen").children("option:selected").val();
    if (origen != "Compra" && origen != "Donación") {
      $("#origen").css('border-color', '#d03e3e');
      $("#origen").css('color', '#d03e3e');
      $("#origen").next().show();
      $("#origen").next().text("Selecciona un origen de adquisición para el vehículo.");
    } else {
      $("#origen").css('border-color', '#ddd');
      $("#origen").css('color', '#888');
      $("#origen").next().hide();
    }
  });

  // Coloca primeros datos de SUDEBIP de acuerdo a sede (localizacion y codigo localizacion)
  $(document).ready(function() {
    var sede = {{=sede_id}};
    if (sede == 1) { // Sartenejas
      $("#sudebip_localizacion").val("{{=localizacion['Sartenejas']}}");
      $("#sudebip_cod_localizacion").val("{{=cod_localizacion['Sartenejas']}}");
    } else if (sede == 2) { // Litoral
      $("#sudebip_localizacion").val("{{=localizacion['Litoral']}}");
      $("#sudebip_cod_localizacion").val("{{=cod_localizacion['Litoral']}}");
    } else {
      $("#sudebip_localizacion").val("");
      $("#sudebip_cod_localizacion").val("");
    }
  });


</script>


  <script type="text/javascript">
    $('.tab-link').click( function() {
        
        var tabID = $(this).attr('data-tab');
        
        $(this).addClass('active').siblings().removeClass('active');
        
        $('#tab-'+tabID).addClass('active').siblings().removeClass('active');
    });
      
      </script>

<script>

        var filtros = false;
      
        $(document).ready(function() {
            // Setup - add a text input to each footer cell
            $('#datatable tfoot th').each( function () {
                var title = $(this).text();
                $(this).html( '<input type="text" placeholder="Filtro" />' );
            } );
         
            // DataTable
            var table = $('#datatable').DataTable();
         
            // Apply the search
            table.columns().every( function () {
                var that = this;
         
                $( 'input', this.footer() ).on( 'keyup change', function () {
                    if ( that.search() !== this.value ) {
                        that
                            .search( this.value )
                            .draw();
                    }
                } );
            } );
      
            $('#datatable tfoot tr').appendTo('#datatable thead');
            $("#datatable thead tr").not("#titulosListado").css("display","none");
        } );
      
        function mostrarFiltro() {
            if (filtros){
              $("#datatable thead tr").not("#titulosListado").css("display","none");
              filtros = false
            }
            else{
              $("#datatable thead tr").not("#titulosListado").css("display","table-row");
              filtros = true
            }
      
        }
      </script>
       
       <script language="javascript">
    
            var table = $('#datatable').DataTable({
            'sDom' : "<'row'f <'buttons'>>"+"<'row'<'col-md-6'l><'col-md-6'i>>"+"<'row'rt>"+"<'row'<'col-md-12'p>>",
            //dom: 'Bfrtip',
            language: {
                url: "{{=URL('static', 'plugins/datatables/l18n/es-ES.json')}}"
            },
            "columnDefs": [
                { "width": "30%", "targets": 0, className: 'dt-body-left' },
                { "width": "10%", "targets": [1,2,3] }
            ],
            initComplete: function(){
                var api = this.api();
        
                new $.fn.dataTable.Buttons(api, {
                buttons: [
        
                    {
                    text:'<i class="fa fa-filter"></i>',
                    action: function(){
                        mostrarFiltro()
                    },
                    className: 'boton-sigulabIzq'
                    },
        
                    {
                        extend: 'collection',
                        text: '<i class="fas fa-save"></i>',
                        className: 'boton-sigulab',
                        buttons: [
                            { extend:'copy', text: 'Copiar' } ,
                            'excel',
                            'csv',
                            'pdf'
                        ]
                    },
                    { extend:'print', text: '<i class="fas fa-print"></i>', className: 'boton-sigulabDer'}
                ]
                });
                //$('#botonModal').addClass('pull-left')
                $('#filtrar').addClass('pull-left');
                $('#espacioBuscar').addClass('pull-left');
        
        
                $('.dataTables_filter').appendTo('#buttons');
        
                api.buttons().container().appendTo('#buttons');
                //$('.dt-buttons').append($('#botonModal'));
                $('.dt-buttons').append($('#filtrar'));
                $('#buttons').append('<br><br>');
                $('.dataTables_info').addClass('pull-right');
                $('.dataTables_filter').addClass('pull-left');
        
                $('#datatable_previous').html('<span class="fa fa-arrow-left"/>');
                $('#datatable_next').html('<span class="fa fa-arrow-right" />');
                
            }
            });
    
        </script>

  {{end}}